/*!
 * Colcade v0.2.0
 * Lightweight masonry layout
 * by David DeSandro
 * MIT license
 */
!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports?module.exports=e():t.Colcade=e()}(window,(function(){function t(t,e){if((t=r(t))&&t.colcadeGUID){var n=i[t.colcadeGUID];return n.option(e),n}this.element=t,this.options={},this.option(e),this.create()}var e=t.prototype;e.option=function(t){this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(this.options,t)};var n=0,i={};function o(e){var n=e.getAttribute("data-colcade").split(","),i={};n.forEach((function(t){var e=t.split(":"),n=e[0].trim(),o=e[1].trim();i[n]=o})),new t(e,i)}function s(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"number"==typeof t.length)for(var n=0;n<t.length;n++)e.push(t[n]);else e.push(t);return e}function a(t,e){return s((e=e||document).querySelectorAll(t))}function r(t){return"string"==typeof t&&(t=document.querySelector(t)),t}return e.create=function(){this.errorCheck();var t=this.guid=++n;this.element.colcadeGUID=t,i[t]=this,this.reload(),this._windowResizeHandler=this.onWindowResize.bind(this),this._loadHandler=this.onLoad.bind(this),window.addEventListener("resize",this._windowResizeHandler),this.element.addEventListener("load",this._loadHandler,!0)},e.errorCheck=function(){var t=[];if(this.element||t.push("Bad element: "+this.element),this.options.columns||t.push("columns option required: "+this.options.columns),this.options.items||t.push("items option required: "+this.options.items),t.length)throw new Error("[Colcade error] "+t.join(". "))},e.reload=function(){this.updateColumns(),this.updateItems(),this.layout()},e.updateColumns=function(){this.columns=a(this.options.columns,this.element)},e.updateItems=function(){this.items=a(this.options.items,this.element)},e.getActiveColumns=function(){return this.columns.filter((function(t){return"none"!=getComputedStyle(t).display}))},e.layout=function(){this.activeColumns=this.getActiveColumns(),this._layout()},e._layout=function(){this.columnHeights=this.activeColumns.map((function(){return 0})),this.layoutItems(this.items)},e.layoutItems=function(t){t.forEach(this.layoutItem,this)},e.layoutItem=function(t){var e=Math.min.apply(Math,this.columnHeights),n=this.columnHeights.indexOf(e);this.activeColumns[n].appendChild(t),this.columnHeights[n]+=t.offsetHeight||1},e.append=function(t){var e=this.getQueryItems(t);this.items=this.items.concat(e),this.layoutItems(e)},e.prepend=function(t){var e=this.getQueryItems(t);this.items=e.concat(this.items),this._layout()},e.getQueryItems=function(t){t=s(t);var e=document.createDocumentFragment();return t.forEach((function(t){e.appendChild(t)})),a(this.options.items,e)},e.measureColumnHeight=function(t){var e=this.element.getBoundingClientRect();this.activeColumns.forEach((function(n,i){if(!t||n.contains(t)){var o=n.lastElementChild.getBoundingClientRect();this.columnHeights[i]=o.bottom-e.top}}),this)},e.onWindowResize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.onDebouncedResize()}.bind(this),100)},e.onDebouncedResize=function(){var t=this.getActiveColumns(),e=t.length==this.activeColumns.length,n=!0;this.activeColumns.forEach((function(e,i){n=n&&e==t[i]})),e&&n||(this.activeColumns=t,this._layout())},e.onLoad=function(t){this.measureColumnHeight(t.target)},e.destroy=function(){this.items.forEach((function(t){this.element.appendChild(t)}),this),window.removeEventListener("resize",this._windowResizeHandler),this.element.removeEventListener("load",this._loadHandler,!0),delete this.element.colcadeGUID,delete i[this.guid]},function(t){if("complete"==document.readyState)return void t();document.addEventListener("DOMContentLoaded",t)}((function(){a("[data-colcade]").forEach(o)})),t.data=function(t){var e=(t=r(t))&&t.colcadeGUID;return e&&i[e]},t.makeJQueryPlugin=function(e){function n(t,n,i){var o;return t.each((function(t,s){var a=e.data(s,"colcade");if(a){var r=a[n].apply(a,i);o=void 0===o?r:o}})),void 0!==o?o:t}function i(n,i){n.each((function(n,o){var s=e.data(o,"colcade");s?(s.option(i),s.layout()):(s=new t(o,i),e.data(o,"colcade",s))}))}(e=e||window.jQuery)&&(e.fn.colcade=function(t){if("string"==typeof t){var e=Array.prototype.slice.call(arguments,1);return n(this,t,e)}return i(this,t),this})},t.makeJQueryPlugin(),t}));let grid=document.querySelector('[data-js="grid"]'),colcade=new Colcade(grid,{columns:'[data-js="column"]',items:'[data-js="tile"]'});Object.prototype.removeItem=function(t){this.hasOwnProperty(t)&&(!isNaN(parseInt(t))&&this instanceof Array?this.splice(t,1):delete this[t])},document.addEventListener("DOMContentLoaded",(function(){let t=document.querySelector('[data-js="modal"]'),e=document.body,n=document.querySelector(".content"),i=document.querySelector('[data-js="buttonRegister"]'),o=document.querySelector('[data-js="buttonClose"]');i.addEventListener("click",(function(i){t.classList.add("js-modal--open"),e.style.setProperty("--js-scrollPosY",`-${window.scrollY}px`),e.classList.add("js-fixed"),n.classList.add("js-blur"),i.preventDefault()})),o.addEventListener("click",(function(i){const o=-1*parseInt(document.body.style.getPropertyValue("--js-scrollPosY")||0);t.classList.remove("js-modal--open"),e.classList.remove("js-fixed"),n.classList.remove("js-blur"),window.scrollTo(0,-1*parseInt(o||"0")),i.preventDefault()}));let s={};(window.onpopstate=function(){let t,e=/\+/g,n=/([^&=]+)=?([^&]*)/g,i=function(t){return decodeURIComponent(t.replace(e," "))},o=window.location.search.substring(1);for(;t=n.exec(o);)i(t[1])in s?(Array.isArray(s[i(t[1])])||(s[i(t[1])]=[s[i(t[1])]]),s[i(t[1])].push(i(t[2]))):s[i(t[1])]=i(t[2])})();let a=document.querySelector('[data-js="filtered-omen-list"]');function r(t){let e=document.querySelectorAll("[data-js-term-"+t+"]");e.forEach(n=>{n.addEventListener("click",i=>{i.preventDefault();let o=n.getAttribute("data-js-term-"+t);s[t]===o?(s.removeItem(t),n.classList.remove("tile__listItem--active")):(s[t]=o,e.forEach(t=>{t.classList.contains("tile__listItem--active")&&t.classList.remove("tile__listItem--active")}),n.classList.add("tile__listItem--active"));for(const[t,e]of Object.entries(s)){let e=document.createElement("li");e.setAttribute("class","nav__link");let n=document.createTextNode(t);e.appendChild(n),document.querySelector('[data-js="breadcrumbs"]').appendChild(e)}let r=encodeURIComponent,c=Object.keys(s).map(t=>r(t)+"="+r(s[t])).join("&");if(console.log(c),null==a)window.location.href="/omen/?"+c;else{let t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){a.innerHTML=this.responseText,colcade.destroy();let t=document.querySelector('[data-js="grid"]');colcade=new Colcade(t,{columns:'[data-js="column"]',items:'[data-js="tile"]'})}},t.open("GET","/omen/ajax/?"+c,!0),t.send()}})})}r("aspect"),r("death"),r("fault")}));