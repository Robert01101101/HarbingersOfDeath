/*!
 * Colcade v0.2.0
 * Lightweight masonry layout
 * by David DeSandro
 * MIT license
 */
!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports?module.exports=e():t.Colcade=e()}(window,(function(){function t(t,e){if((t=c(t))&&t.colcadeGUID){var n=o[t.colcadeGUID];return n.option(e),n}this.element=t,this.options={},this.option(e),this.create()}var e=t.prototype;e.option=function(t){this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(this.options,t)};var n=0,o={};function i(e){var n=e.getAttribute("data-colcade").split(","),o={};n.forEach((function(t){var e=t.split(":"),n=e[0].trim(),i=e[1].trim();o[n]=i})),new t(e,o)}function s(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"number"==typeof t.length)for(var n=0;n<t.length;n++)e.push(t[n]);else e.push(t);return e}function a(t,e){return s((e=e||document).querySelectorAll(t))}function c(t){return"string"==typeof t&&(t=document.querySelector(t)),t}return e.create=function(){this.errorCheck();var t=this.guid=++n;this.element.colcadeGUID=t,o[t]=this,this.reload(),this._windowResizeHandler=this.onWindowResize.bind(this),this._loadHandler=this.onLoad.bind(this),window.addEventListener("resize",this._windowResizeHandler),this.element.addEventListener("load",this._loadHandler,!0)},e.errorCheck=function(){var t=[];if(this.element||t.push("Bad element: "+this.element),this.options.columns||t.push("columns option required: "+this.options.columns),this.options.items||t.push("items option required: "+this.options.items),t.length)throw new Error("[Colcade error] "+t.join(". "))},e.reload=function(){this.updateColumns(),this.updateItems(),this.layout()},e.updateColumns=function(){this.columns=a(this.options.columns,this.element)},e.updateItems=function(){this.items=a(this.options.items,this.element)},e.getActiveColumns=function(){return this.columns.filter((function(t){return"none"!=getComputedStyle(t).display}))},e.layout=function(){this.activeColumns=this.getActiveColumns(),this._layout()},e._layout=function(){this.columnHeights=this.activeColumns.map((function(){return 0})),this.layoutItems(this.items)},e.layoutItems=function(t){t.forEach(this.layoutItem,this)},e.layoutItem=function(t){var e=Math.min.apply(Math,this.columnHeights),n=this.columnHeights.indexOf(e);this.activeColumns[n].appendChild(t),this.columnHeights[n]+=t.offsetHeight||1},e.append=function(t){var e=this.getQueryItems(t);this.items=this.items.concat(e),this.layoutItems(e)},e.prepend=function(t){var e=this.getQueryItems(t);this.items=e.concat(this.items),this._layout()},e.getQueryItems=function(t){t=s(t);var e=document.createDocumentFragment();return t.forEach((function(t){e.appendChild(t)})),a(this.options.items,e)},e.measureColumnHeight=function(t){var e=this.element.getBoundingClientRect();this.activeColumns.forEach((function(n,o){if(!t||n.contains(t)){var i=n.lastElementChild.getBoundingClientRect();this.columnHeights[o]=i.bottom-e.top}}),this)},e.onWindowResize=function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){this.onDebouncedResize()}.bind(this),100)},e.onDebouncedResize=function(){var t=this.getActiveColumns(),e=t.length==this.activeColumns.length,n=!0;this.activeColumns.forEach((function(e,o){n=n&&e==t[o]})),e&&n||(this.activeColumns=t,this._layout())},e.onLoad=function(t){this.measureColumnHeight(t.target)},e.destroy=function(){this.items.forEach((function(t){this.element.appendChild(t)}),this),window.removeEventListener("resize",this._windowResizeHandler),this.element.removeEventListener("load",this._loadHandler,!0),delete this.element.colcadeGUID,delete o[this.guid]},function(t){if("complete"==document.readyState)return void t();document.addEventListener("DOMContentLoaded",t)}((function(){a("[data-colcade]").forEach(i)})),t.data=function(t){var e=(t=c(t))&&t.colcadeGUID;return e&&o[e]},t.makeJQueryPlugin=function(e){function n(t,n,o){var i;return t.each((function(t,s){var a=e.data(s,"colcade");if(a){var c=a[n].apply(a,o);i=void 0===i?c:i}})),void 0!==i?i:t}function o(n,o){n.each((function(n,i){var s=e.data(i,"colcade");s?(s.option(o),s.layout()):(s=new t(i,o),e.data(i,"colcade",s))}))}(e=e||window.jQuery)&&(e.fn.colcade=function(t){if("string"==typeof t){var e=Array.prototype.slice.call(arguments,1);return n(this,t,e)}return o(this,t),this})},t.makeJQueryPlugin(),t}));let grid=document.querySelector('[data-js="grid"]'),colcade=new Colcade(grid,{columns:'[data-js="column"]',items:'[data-js="tile"]'});document.addEventListener("DOMContentLoaded",(function(){let t=document.querySelector('[data-js="modal"]'),e=document.body,n=document.querySelector(".content"),o=document.querySelector('[data-js="buttonRegister"]'),i=document.querySelector('[data-js="buttonClose"]');o.addEventListener("click",(function(o){t.classList.add("js-modal--open"),e.style.setProperty("--js-scrollPosY",`-${window.scrollY}px`),e.classList.add("js-fixed"),n.classList.add("js-blur"),o.preventDefault()})),i.addEventListener("click",(function(o){const i=-1*parseInt(document.body.style.getPropertyValue("--js-scrollPosY")||0);t.classList.remove("js-modal--open"),e.classList.remove("js-fixed"),n.classList.remove("js-blur"),window.scrollTo(0,-1*parseInt(i||"0")),o.preventDefault()}));let s={};(window.onpopstate=function(){let t,e=/\+/g,n=/([^&=]+)=?([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(e," "))},i=window.location.search.substring(1);for(;t=n.exec(i);)o(t[1])in s?(Array.isArray(s[o(t[1])])||(s[o(t[1])]=[s[o(t[1])]]),s[o(t[1])].push(o(t[2]))):s[o(t[1])]=o(t[2])})();let a=document.querySelector('[data-js="filtered-omen-list"]'),c=document.querySelectorAll("[data-js-term-death]");c.forEach(t=>{t.addEventListener("click",e=>{s.death=t.getAttribute("data-js-term-death"),c.forEach(t=>{t.classList.contains("tile__listItem--active")&&t.classList.remove("tile__listItem--active")}),t.classList.add("tile__listItem--active");var n=encodeURIComponent,o=Object.keys(s).map(t=>n(t)+"="+n(s[t])).join("&");if(null==a)window.location.href="/omen/?"+o;else{let t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){console.log(this),console.log(this.responseText),a.innerHTML=this.responseText,colcade.destroy();let t=document.querySelector('[data-js="grid"]');colcade=new Colcade(t,{columns:'[data-js="column"]',items:'[data-js="tile"]'})}},t.open("GET","/omen/ajax/?"+o,!0),t.send()}})});let l=document.querySelectorAll("[data-js-term-aspect]");l.forEach(t=>{t.addEventListener("click",e=>{s.aspect=t.getAttribute("data-js-term-aspect"),l.forEach(t=>{t.classList.contains("tile__listItem--active")&&t.classList.remove("tile__listItem--active")}),t.classList.add("tile__listItem--active");var n=encodeURIComponent,o=Object.keys(s).map(t=>n(t)+"="+n(s[t])).join("&");if(null==a)window.location.href="/omen/?"+o;else{let t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){console.log(this),console.log(this.responseText),a.innerHTML=this.responseText,colcade.destroy();let t=document.querySelector('[data-js="grid"]');colcade=new Colcade(t,{columns:'[data-js="column"]',items:'[data-js="tile"]'})}},t.open("GET","/omen/ajax/?"+o,!0),t.send()}})});let r=document.querySelectorAll("[data-js-term-fault]");r.forEach(t=>{t.addEventListener("click",e=>{s.fault=t.getAttribute("data-js-term-fault"),r.forEach(t=>{t.classList.contains("tile__listItem--active")&&t.classList.remove("tile__listItem--active")}),t.classList.add("tile__listItem--active");var n=encodeURIComponent,o=Object.keys(s).map(t=>n(t)+"="+n(s[t])).join("&");if(null==a)window.location.href="/omen/?"+o;else{let t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){console.log(this),console.log(this.responseText),a.innerHTML=this.responseText,colcade.destroy();let t=document.querySelector('[data-js="grid"]');colcade=new Colcade(t,{columns:'[data-js="column"]',items:'[data-js="tile"]'})}},t.open("GET","/omen/ajax/?"+o,!0),t.send()}})})}));